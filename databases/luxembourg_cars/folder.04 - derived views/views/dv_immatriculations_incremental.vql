CREATE OR REPLACE VIEW dv_immatriculations_incremental FOLDER = '/04 - derived views' AS SELECT period, codcar, libcar, cateu, brand_code, brand_name, typcom, mvid, i4x4, lon, lar, hau, essim, nbrcyl, pkw, cyd, infco2, l100km, infparticule, infnox, eunorm, libcrb, catstc, datcirprm, datcir_gd, infouti, induti, codeop, model_id, paypvn FROM (SELECT essim, mvid, infparticule, eunorm, pkw, libcrb, lon, infnox, infco2, induti, typcom, l100km, libcar, lar, codmrq AS brand_code, hau, libmrq AS brand_name, datcir_gd, cateu, i4x4, codcar, nbrcyl, datcirprm, period, codeop, model_id, infouti, paypvn, cyd, catstc FROM iv_data_public_lu_operations_delta_all UNION SELECT codmrq AS brand_code, typcom, hau, libmrq AS brand_name, infnox, codcar, i4x4, datcir_gd, cyd, period, cateu, nbrcyl, model_id, codeop, catstc, infouti, paypvn, mvid, infparticule, induti, essim, eunorm, datcirprm, lon, infco2, libcrb, l100km, libcar, lar, pkw FROM iv_immatriculations_initial_load);

ALTER VIEW dv_immatriculations_incremental
 LAYOUT (iv_data_public_lu_operations_delta_all = [130, 50, 200, 225], iv_immatriculations_initial_load = [736, 46, 200, 225]);

