CREATE OR REPLACE VIEW dv_immatriculations FOLDER = '/04 - derived views' AS SELECT iv_immatriculations.codcar AS codcar, iv_immatriculations.libcar AS libcar, iv_immatriculations.cateu AS cateu, iv_immatriculations.codmrq AS codmrq, iv_immatriculations.libmrq AS libmrq, iv_immatriculations.typcom AS typcom, iv_immatriculations.datcirprm AS datcirprm, iv_immatriculations.datcir_gd AS datcir_gd, iv_immatriculations.datcir AS datcir, iv_immatriculations.dathorcir AS dathorcir, iv_immatriculations.mvid AS mvid, iv_immatriculations.i4x4 AS i4x4, iv_immatriculations.lon AS lon, iv_immatriculations.lar AS lar, iv_immatriculations.hau AS hau, iv_immatriculations.essim AS essim, iv_immatriculations.libcrb AS libcrb, iv_immatriculations.nbrcyl AS nbrcyl, iv_immatriculations.pkw AS pkw, iv_immatriculations.cyd AS cyd, iv_immatriculations.infco2 AS infco2, iv_immatriculations.l100km AS l100km, iv_immatriculations.infparticule AS infparticule, iv_immatriculations.infnox AS infnox, iv_immatriculations.eunorm AS eunorm, iv_statec.label_en AS label_statec, bv_car_taxes.taxrate AS taxrate FROM ((iv_immatriculations AS iv_immatriculations LEFT OUTER JOIN iv_statec AS iv_statec ON iv_immatriculations.catstc = iv_statec.code ) LEFT OUTER JOIN bv_fuel_mapping AS bv_fuel_mapping ON iv_immatriculations.libcrb = bv_fuel_mapping.input_fuel ) LEFT OUTER JOIN bv_car_taxes AS bv_car_taxes ON (bv_fuel_mapping.rest_fuel = bv_car_taxes.fuel AND iv_immatriculations.infco2 = bv_car_taxes.co2)  CONTEXT (DATAMOVEMENTPLAN = bv_car_taxes : OFF bv_fuel_mapping : OFF iv_statec : OFF);

ALTER VIEW dv_immatriculations
 LAYOUT (iv_immatriculations = [40, 40, 200, 225], iv_statec = [310, 20, 200, 86], bv_fuel_mapping = [450, 140, 200, 66], bv_car_taxes = [720, 250, 200, 126]);

