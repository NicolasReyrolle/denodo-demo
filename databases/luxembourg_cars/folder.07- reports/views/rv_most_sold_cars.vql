CREATE OR REPLACE VIEW rv_most_sold_cars FOLDER = '/07- reports'
    PRIMARY KEY ( 'brand_name' , 'model' , 'period' ) AS SELECT fv_brand.brand_name AS brand_name, fv_model.model AS model, fv_cars_agg.period AS period, sum(fv_cars_agg.count) AS count FROM ((fv_cars_agg AS fv_cars_agg INNER JOIN fv_model AS fv_model ON fv_cars_agg.model_id = fv_model.model_id ) INNER JOIN fv_brand AS fv_brand ON fv_model.brand_code = fv_brand.brand_code ) INNER JOIN fv_current_period AS fv_current_period ON fv_cars_agg.period = fv_current_period.period  GROUP BY fv_brand.brand_name, fv_model.model, fv_cars_agg.period;

ALTER VIEW rv_most_sold_cars
 LAYOUT (fv_cars_agg = [390, 30, 200, 105], fv_model = [760, 30, 200, 86], fv_brand = [1060, 30, 200, 66], fv_current_period = [113, 56, 200, 46]);

